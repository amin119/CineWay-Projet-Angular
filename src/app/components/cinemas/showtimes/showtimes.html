<div class="mt-4">
  <h4>Showtimes</h4>
  <div class="d-flex gap-2 mb-3">
    <button (click)="onTodayClick()" class="btn btn-primary">Today</button>
    <button (click)="onTomorrowClick()" class="btn btn-primary">Tomorrow</button>
    <input
      type="date"
      (blur)="onDatePickerChange($event.target.value)"
      class="form-control w-auto"
    />
  </div>

  @if (!isLoading()) { @if (error()) {
  <div class="text-danger text-center py-3">
    <i class="bi bi-exclamation-triangle-fill"></i>
    Failed to load showtimes. Please try again later.
  </div>
  } @else if (showTimes()?.length === 0) {
  <p>No showtimes available for {{ chosenDate() }}</p>
  } @else { @for (item of showTimes(); track item.movie.id) {
  <div class="movie-showtime-section mb-4">
    <div class="d-flex gap-3 mb-3 bg-dark p-3 rounded">
      <img
        [src]="item.movie.image_url"
        [alt]="item.movie.title"
        class="rounded"
        style="width: 80px; height: 130px; object-fit: cover"
      />
      <div class="flex-grow-1">
        <h4 class="mb-2">{{ item.movie.title }}</h4>
        <div class="text-secondary mb-1">
          <i class="bi bi-clock"></i> {{ item.movie.duration_minutes | TimeToHours }}
        </div>
        <div class="text-secondary mb-2">
          <span class="badge bg-opacity-10 border border-white">{{ item.movie.genre }}</span>
        </div>
        <div class="text-warning"><i class="bi bi-star-fill"></i> {{ item.movie.rating }}</div>
      </div>
    </div>
    <div class="showtime-badges d-flex flex-wrap gap-2">
      @for (s of item.showtimes; track s.id) {
      <button
        class="btn btn-outline-primary btn-sm p-2 rounded-2"
        (click)="chooseShowtime(s.id, item.movie)"
      >
        {{ s.screening_time | date : 'shortTime' }}
      </button>
      }
    </div>
  </div>
  } } } @else {
  <div class="d-flex flex-column gap-3">
    <div class="d-flex gap-3 mb-3 bg-dark p-3 rounded placeholder-glow">
      <div class="placeholder rounded" style="width: 80px; height: 120px"></div>
      <div class="flex-grow-1">
        <div class="placeholder col-6 mb-2 rounded"></div>
      </div>
    </div>
  </div>
  }
</div>
